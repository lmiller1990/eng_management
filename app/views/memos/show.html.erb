<% content_for :title, "Manage Invitations" %>

<div class="w-full">
  <% if notice.present? %>
    <p
      class="
        py-2 px-3 bg-green-50 mb-5 text-green-500 font-medium rounded-md inline-block
      "
      id="notice"
    ><%= notice %></p>
  <% end %>

  <div class="flex justify-between items-center mb-4">
    <h1 class="font-bold text-xl">Invite Editors</h1>
    <%= link_to "Back to Memos", memos_path, class: "btn btn-sm btn-ghost" %>
  </div>

  <%= form_with url: memo_invitations_path(@memo), method: :post, class: "flex gap-2 mb-6" do |form| %>
    <%= form.email_field :email,
                     placeholder: "email@example.com",
                     class: "input input-bordered flex-1" %>
    <%= form.submit "Send Invitation", class: "btn btn-primary" %>
  <% end %>

  <h2 class="font-bold text-xl mb-4">Pending Invitations</h2>

  <div class="overflow-x-auto">
    <% pending = @memo.memo_invitations.pending %>
    <% if pending.any? %>
      <table class="table">
        <thead>
          <tr>
            <th>Email</th>
            <th>Expires</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% pending.each do |invitation| %>
            <tr>
              <td><%= invitation.email %></td>
              <td><%= time_ago_in_words(invitation.expires_at) %>
                from now</td>
              <td>
                <%= button_to "Cancel",
                memo_invitation_path(@memo, invitation),
                method: :delete,
                class: "btn btn-error btn-xs" %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    <% else %>
      <p class="text-center my-10 text-gray-500">No pending invitations</p>
    <% end %>
  </div>
</div>
